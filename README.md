<img width="910" height="791" alt="image" src="https://github.com/user-attachments/assets/87aaf7f1-bb95-4e1f-a8e3-264e6bd47de3" />
<img width="910" height="791" alt="image" src="https://github.com/user-attachments/assets/cd3b19ae-1c5d-4cdb-9387-369b5fdf0d4d" />


# 微博发送器项目文档

## 项目简介
本项目是一个基于 Python 的微博自动化工具，集成了扫码登录和微博发送功能。通过简洁的 GUI 界面，用户可以轻松实现微博账号的登录管理、内容编辑、图片上传以及标签管理等操作。

## 功能特性

### 1. 界面与交互
- **现代化 UI**：使用 `ttkbootstrap` 库构建，支持多种主题切换（明亮白、暗夜黑、护眼黄、少女粉等）。
- **一体化设计**：将登录和发送功能整合在同一个应用程序中，通过选项卡（Tab）轻松切换。
- **自定义图标**：支持自定义程序图标，提升用户体验。

### 2. 扫码登录
- **二维码获取**：自动调用 Selenium 或手动模式获取微博登录二维码。
- **状态监控**：实时监控登录状态，扫码成功后自动保存 Cookies。
- **Cookie 管理**：支持 Cookies 的本地保存、加载和清除，实现免重复登录。
- **多模式支持**：自动检测是否安装 Selenium，无 Selenium 环境下支持手动辅助登录。

### 3. 微博发送
- **内容编辑**：支持文本输入、剪贴板粘贴。
- **图片支持**：
  - 支持单图/多图上传（最多 18 张）。
  - 支持拖拽、文件选择、剪贴板粘贴图片。
  - 图片预览与缩略图显示。
- **标签管理**：
  - 内置常用标签（如 #生活手记#、#程序员日常# 等）。
  - 支持自定义添加、删除常用标签。
  - 自动为标签添加 `#` 符号。
- **发送控制**：后台线程发送，避免界面卡顿，发送结果实时反馈。

## 快速开始

### 依赖安装
请确保已安装 Python 3.x，并运行以下命令安装所需依赖：
```bash
pip install requests ttkbootstrap selenium pillow
```
*注：使用 Selenium 功能需要安装对应的浏览器驱动（如 chromedriver）。*

### 运行程序
直接运行 `Weibo_All_In_One.py` 即可启动程序：
```bash
python Weibo_All_In_One.py
```

## 使用说明

### 1. 登录
1. 启动程序，切换到“扫码登录”选项卡。
2. 点击“获取登录二维码”。
3. 使用微博手机 APP 扫描显示的二维码。
4. 登录成功后，状态栏会显示“已登录”，Cookies 自动保存。

### 2. 发送微博
1. 切换到“发送微博”选项卡。
2. 输入微博正文内容。
3. 点击“选择图片”或直接粘贴图片（支持 Ctrl+V）。
4. 点击常用标签或手动输入标签。
5. 点击“发送微博”按钮完成发布。

## 目录结构
```
WeiboSender/
├── Weibo_All_In_One.py    # 主程序（整合版）
├── Weibo_Login_GUI.py     # 独立登录工具（旧版）
├── Weibo_Sender_GUI.py    # 独立发送工具（旧版）
├── cookie/                # Cookie 保存目录
│   └── cookie.json
├── temp/                  # 临时文件目录
└── 微博发送模板.ico        # 程序图标
```

## 注意事项
- 请勿频繁发送重复内容，以免触发微博风控。
- Cookie 文件包含敏感登录信息，请妥善保管，勿泄露给他人。
- 如遇到 Selenium 启动失败，请检查浏览器驱动版本是否与浏览器匹配。

## 作者
@小庄-Python办公
